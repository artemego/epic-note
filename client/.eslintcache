[{"C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\AppProviders.js":"1","C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\login\\LoginPage.jsx":"2","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\LoginForm.js":"3","C:\\Users\\user\\dev\\epic-note\\client\\src\\App.js":"4","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\CustomLink.js":"5","C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\Notes.js":"6","C:\\Users\\user\\dev\\epic-note\\client\\src\\PrivateApp.js":"7","C:\\Users\\user\\dev\\epic-note\\client\\src\\schemas\\userSchema.js":"8","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\SideBar.js":"9","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\selectMenu\\SelectMenu.jsx":"10","C:\\Users\\user\\dev\\epic-note\\client\\src\\PublicApp.js":"11","C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\AuthContext.js":"12","C:\\Users\\user\\dev\\epic-note\\client\\src\\reportWebVitals.js":"13","C:\\Users\\user\\dev\\epic-note\\client\\src\\api\\notesApi.js":"14","C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\getCaretCoordinates.js":"15","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\editableBlock\\EditableBlock.jsx":"16","C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\blockEditor\\BlockEditor.jsx":"17","C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\setCaretToEnd.js":"18","C:\\Users\\user\\dev\\epic-note\\client\\src\\routes\\privateRoutes.js":"19","C:\\Users\\user\\dev\\epic-note\\client\\src\\index.js":"20","C:\\Users\\user\\dev\\epic-note\\client\\src\\hooks\\useComponentDidUpdate.js":"21","C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\actions.js":"22","C:\\Users\\user\\dev\\epic-note\\client\\src\\routes\\publicRoutes.js":"23","C:\\Users\\user\\dev\\epic-note\\client\\src\\api\\authApi.js":"24","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\AddPageModal.js":"25","C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\register\\RegisterPage.jsx":"26","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\RegisterForm.js":"27","C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\objectId.js":"28","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\ButtonBlock.jsx":"29","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\FolderTree.jsx":"30","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\PageItem.jsx":"31","C:\\Users\\user\\dev\\epic-note\\client\\src\\hooks\\usePrevious.js":"32","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\actionMenu\\ActionMenu.jsx":"33","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\ToggleList.jsx":"34","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\TodoList.jsx":"35","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\Placeholder.js":"36"},{"size":245,"mtime":1616407800691,"results":"37","hashOfConfig":"38"},{"size":536,"mtime":1620813244928,"results":"39","hashOfConfig":"38"},{"size":3906,"mtime":1620817490965,"results":"40","hashOfConfig":"38"},{"size":1642,"mtime":1620817623887,"results":"41","hashOfConfig":"38"},{"size":318,"mtime":1617195810058,"results":"42","hashOfConfig":"38"},{"size":1674,"mtime":1620828740392,"results":"43","hashOfConfig":"38"},{"size":315,"mtime":1620818495778,"results":"44","hashOfConfig":"38"},{"size":272,"mtime":1615892211340,"results":"45","hashOfConfig":"38"},{"size":5521,"mtime":1620583189520,"results":"46","hashOfConfig":"38"},{"size":3821,"mtime":1620737987761,"results":"47","hashOfConfig":"38"},{"size":302,"mtime":1620818384754,"results":"48","hashOfConfig":"38"},{"size":3190,"mtime":1620499257832,"results":"49","hashOfConfig":"38"},{"size":362,"mtime":1611586550203,"results":"50","hashOfConfig":"38"},{"size":2108,"mtime":1620497524299,"results":"51","hashOfConfig":"38"},{"size":364,"mtime":1612120047169,"results":"52","hashOfConfig":"38"},{"size":18490,"mtime":1620764866460,"results":"53","hashOfConfig":"38"},{"size":5784,"mtime":1620582977743,"results":"54","hashOfConfig":"38"},{"size":280,"mtime":1612120092450,"results":"55","hashOfConfig":"38"},{"size":515,"mtime":1620813140464,"results":"56","hashOfConfig":"38"},{"size":380,"mtime":1616111760327,"results":"57","hashOfConfig":"38"},{"size":300,"mtime":1616408656617,"results":"58","hashOfConfig":"38"},{"size":657,"mtime":1616172489692,"results":"59","hashOfConfig":"38"},{"size":969,"mtime":1616503717713,"results":"60","hashOfConfig":"38"},{"size":2323,"mtime":1620498276243,"results":"61","hashOfConfig":"38"},{"size":2407,"mtime":1617126721004,"results":"62","hashOfConfig":"38"},{"size":581,"mtime":1617195573440,"results":"63","hashOfConfig":"38"},{"size":3635,"mtime":1617197301948,"results":"64","hashOfConfig":"38"},{"size":315,"mtime":1617042982192,"results":"65","hashOfConfig":"38"},{"size":410,"mtime":1619558648667,"results":"66","hashOfConfig":"38"},{"size":5119,"mtime":1620828441252,"results":"67","hashOfConfig":"38"},{"size":1975,"mtime":1620584656874,"results":"68","hashOfConfig":"38"},{"size":217,"mtime":1616695303307,"results":"69","hashOfConfig":"38"},{"size":1064,"mtime":1620596150402,"results":"70","hashOfConfig":"38"},{"size":1189,"mtime":1620666819876,"results":"71","hashOfConfig":"38"},{"size":2259,"mtime":1620764846567,"results":"72","hashOfConfig":"38"},{"size":767,"mtime":1620829383532,"results":"73","hashOfConfig":"38"},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},"ew1dsd",{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"80","messages":"81","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"82","usedDeprecatedRules":"79"},{"filePath":"83","messages":"84","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"85","messages":"86","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"87","messages":"88","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"89","messages":"90","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"91","messages":"92","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"96","usedDeprecatedRules":"79"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"99","messages":"100","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"101","messages":"102","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"103"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"106","messages":"107","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"108","messages":"109","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"110","messages":"111","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"112","messages":"113","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"114","usedDeprecatedRules":"79"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"117"},{"filePath":"118","messages":"119","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"120","messages":"121","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"122","messages":"123","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"124","usedDeprecatedRules":"79"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"129","usedDeprecatedRules":"79"},{"filePath":"130","messages":"131","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"134"},{"filePath":"135","messages":"136","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"79"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"141"},{"filePath":"142","messages":"143","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"144","messages":"145","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"146","messages":"147","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"103"},{"filePath":"148","messages":"149","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"150"},{"filePath":"151","messages":"152","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"155","messages":"156","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"157","messages":"158","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\AppProviders.js",[],["159","160"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\login\\LoginPage.jsx",[],["161","162"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\LoginForm.js",["163","164","165","166"],"import React, { useEffect, useState } from \"react\";\r\n\r\nimport { useForm } from \"react-hook-form\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport userSchema from \"../schemas/userSchema\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport {\r\n  Stack,\r\n  Button,\r\n  FormControl,\r\n  FormLabel,\r\n  Input,\r\n  InputGroup,\r\n  InputRightElement,\r\n  FormHelperText,\r\n  FormErrorMessage,\r\n} from \"@chakra-ui/react\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\n\r\n// Todo: скорее всего нужно объединить это с registerForm в один файл\r\n\r\nexport default function LoginForm() {\r\n  const history = useHistory();\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const { register, handleSubmit, errors } = useForm({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(userSchema),\r\n  });\r\n\r\n  const { login } = useAuth();\r\n\r\n  const { isAuth, error, isLoading } = useAuth().state;\r\n\r\n  const handleLogin = (data) => {\r\n    console.log(data);\r\n    login(data);\r\n  };\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"redirecting\" + isAuth);\r\n  //   if (isAuth) history.push(\"/\");\r\n  // }, [isAuth]);\r\n\r\n  return (\r\n    <>\r\n      <form>\r\n        <Stack maxWidth={1200} margin=\"auto\" spacing={5} marginTop={5}>\r\n          <FormControl\r\n            isInvalid={!!errors?.email?.message}\r\n            errortext={errors?.email?.message}\r\n          >\r\n            <FormLabel htmlFor=\"email\">Email Address</FormLabel>\r\n            <Input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              name=\"email\"\r\n              aria-describedby=\"email-helper-text\"\r\n              ref={register}\r\n            />\r\n            <FormErrorMessage>{errors.email?.message}</FormErrorMessage>\r\n            <FormHelperText id=\"email-helper-text\">\r\n              Enter your email\r\n            </FormHelperText>\r\n          </FormControl>\r\n          <FormControl\r\n            isInvalid={!!errors?.password?.message}\r\n            errortext={errors?.password?.message}\r\n          >\r\n            <FormLabel htmlFor=\"password\">Password</FormLabel>\r\n            <InputGroup>\r\n              <Input\r\n                type={showPassword ? \"text\" : \"password\"}\r\n                id=\"password\"\r\n                name=\"password\"\r\n                aria-describedby=\"password-helper-text\"\r\n                autoComplete=\"off\"\r\n                ref={register}\r\n              />\r\n              <InputRightElement>\r\n                <Button\r\n                  h=\"1.75rem\"\r\n                  size=\"sm\"\r\n                  mr=\"1rem\"\r\n                  onClick={() => {\r\n                    setShowPassword(!showPassword);\r\n                  }}\r\n                >\r\n                  {showPassword ? \"Hide\" : \"Show\"}\r\n                </Button>\r\n              </InputRightElement>\r\n            </InputGroup>\r\n            <FormErrorMessage>{errors.password?.message}</FormErrorMessage>\r\n            <FormHelperText id=\"password-helper-text\">\r\n              Enter your password\r\n            </FormHelperText>\r\n          </FormControl>\r\n          <FormControl\r\n            isInvalid={!!error?.message}\r\n            errortext={error?.message}\r\n            display=\"flex\"\r\n            alignItems=\"center\"\r\n            flexDirection=\"column\"\r\n          >\r\n            <Button\r\n              type=\"submit\"\r\n              isLoading={isLoading}\r\n              onClick={handleSubmit(handleLogin)}\r\n              colorScheme=\"orange\"\r\n              w=\"100%\"\r\n              disabled={\r\n                !!errors.email ||\r\n                !!errors.password ||\r\n                errors.confirmPassword ||\r\n                isLoading === true\r\n              }\r\n            >\r\n              Login\r\n            </Button>\r\n            <FormErrorMessage>{error?.message}</FormErrorMessage>\r\n          </FormControl>\r\n        </Stack>\r\n      </form>\r\n    </>\r\n  );\r\n}\r\n","C:\\Users\\user\\dev\\epic-note\\client\\src\\App.js",["167","168"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\CustomLink.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\Notes.js",["169"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\PrivateApp.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\schemas\\userSchema.js",[],["170","171"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\SideBar.js",["172","173","174","175","176","177","178","179","180"],"import { Button } from \"@chakra-ui/button\";\r\nimport {\r\n  Box,\r\n  Flex,\r\n  Heading,\r\n  IconButton,\r\n  Slide,\r\n  useDisclosure,\r\n  VStack,\r\n  Text,\r\n  Spinner,\r\n  Icon,\r\n  Menu,\r\n  MenuButton,\r\n  MenuList,\r\n  MenuItem,\r\n} from \"@chakra-ui/react\";\r\nimport React, { useState } from \"react\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport * as notesApi from \"../api/notesApi\";\r\nimport { useQuery } from \"react-query\";\r\nimport { useHistory } from \"react-router\";\r\nimport { AddIcon, ArrowLeftIcon, ArrowRightIcon } from \"@chakra-ui/icons\";\r\nimport AddPageModal from \"./AddPageModal\";\r\nimport objectId from \"../helpers/objectId\";\r\nimport FolderTree from \"./FolderTree\";\r\n\r\nexport default function SideBar({ pageId }) {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [isFetching, setIsFetching] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const [deletingId, setDeletingId] = useState(null);\r\n  const { isOpen, onToggle } = useDisclosure();\r\n  const { logout } = useAuth();\r\n  const { accessToken } = useAuth().state;\r\n  const history = useHistory();\r\n\r\n  // react-query\r\n  const { data, error, isLoading, isError, refetch } = useQuery(\r\n    \"pages\",\r\n    async () => {\r\n      return await notesApi.getPages(accessToken);\r\n    }\r\n  );\r\n\r\n  const btnRef = React.useRef();\r\n  const position = isOpen ? \"sticky\" : \"fixed\";\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n  };\r\n\r\n  const handlePageClick = (pageId) => {\r\n    history.push(`/${pageId}`);\r\n  };\r\n\r\n  // console.log(\"data: \" + JSON.stringify(data));\r\n  // if (!isLoading) {\r\n  //   console.log(data.pages);\r\n  // }\r\n\r\n  const handleModalClose = () => {\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  const handleModalOpen = () => {\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleModalSaveClick = async ({ pageTitle }) => {\r\n    // add page запрос на сервер\r\n    console.log(\"in handle add page\");\r\n    setIsFetching(true);\r\n    const initialBlock = { _id: objectId(), tag: \"p\", html: \"\" };\r\n    await notesApi.addPage(accessToken, pageTitle, initialBlock);\r\n    setIsFetching(false);\r\n    setIsModalOpen(false);\r\n    refetch();\r\n  };\r\n\r\n  const handlePageDelete = async (pageId) => {\r\n    // delete page запрос на сервер\r\n    setIsDeleting(true);\r\n    setDeletingId(pageId);\r\n    // console.log(\"handlePageDelete, id: \" + pageId);\r\n    await notesApi.deletePage(accessToken, pageId);\r\n    setIsDeleting(false);\r\n    setDeletingId(null);\r\n    refetch();\r\n    console.log(\"in delete page\");\r\n  };\r\n\r\n  // здесь мы просто наверное будем отсылать запрос на обновление страниц, на клиенте обновление уже произойдет в дереве, хотя хз\r\n  const handleUpdatePages = async (newTree) => {\r\n    console.log(\"in update pages\");\r\n    notesApi.updatePages(accessToken, newTree);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div style={{ position: \"fixed\", left: \"5px\", top: \"5px\", zIndex: 100 }}>\r\n        <Button ref={btnRef} chcolorSeme=\"orange\" onClick={onToggle}>\r\n          Pages <ArrowRightIcon ml=\"10px\" />\r\n        </Button>\r\n      </div>\r\n      <Slide\r\n        direction=\"left\"\r\n        in={isOpen}\r\n        style={{\r\n          height: \"100vh\",\r\n          width: \"300px\",\r\n          zIndex: 100,\r\n          position: position,\r\n        }}\r\n      >\r\n        <VStack\r\n          color=\"black\"\r\n          bg=\"#F7F6F3\"\r\n          rounded=\"md\"\r\n          h=\"100vh\"\r\n          w=\"300px\"\r\n          overflowY=\"scroll\"\r\n        >\r\n          <Box p={2.5} mr=\"5px\" ml=\"5px\" w=\"100%\" position=\"relative\">\r\n            <Flex justifyContent=\"space-between\">\r\n              <Heading fontSize={28}>User Pages </Heading>\r\n              <Button\r\n                aria-label=\"Close Control Panel\"\r\n                onClick={handleLogout}\r\n                colorScheme=\"orange\"\r\n              >\r\n                Logout\r\n              </Button>\r\n              <Button\r\n                aria-label=\"Close Control Panel\"\r\n                onClick={onToggle}\r\n                colorScheme=\"orange\"\r\n                ml=\"5px\"\r\n              >\r\n                Close\r\n                <ArrowLeftIcon ml=\"10px\" />\r\n              </Button>\r\n            </Flex>\r\n          </Box>\r\n          {isLoading ? (\r\n            <Spinner />\r\n          ) : (\r\n            <FolderTree\r\n              handlePageClick={handlePageClick}\r\n              handlePageDelete={handlePageDelete}\r\n              pageId={pageId}\r\n              isDeleting={isDeleting}\r\n              deletingId={deletingId}\r\n              handleUpdatePages={handleUpdatePages}\r\n              pagesData={data.pages}\r\n            />\r\n          )}\r\n\r\n          <AddPageModal\r\n            isOpen={isModalOpen}\r\n            onClose={handleModalClose}\r\n            onSave={handleModalSaveClick}\r\n            isLoading={isFetching}\r\n          />\r\n\r\n          <Box\r\n            onClick={handleModalOpen}\r\n            p={2}\r\n            borderWidth=\"1px\"\r\n            m=\"5px\"\r\n            w=\"100%\"\r\n            _hover={{ bg: \"#E8E6E1\", cursor: \"pointer\" }}\r\n            style={{ transition: \".2s ease-in-out\" }}\r\n            position=\"fixed\"\r\n            bottom=\"0px\"\r\n            left=\"0px\"\r\n            h=\"65px\"\r\n            display=\"flex\"\r\n            alignItems=\"center\"\r\n          >\r\n            <AddIcon />\r\n            <Heading fontSize=\"xl\" ml=\"15px\">\r\n              New page\r\n            </Heading>\r\n          </Box>\r\n        </VStack>\r\n      </Slide>\r\n    </>\r\n  );\r\n}\r\n","C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\selectMenu\\SelectMenu.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\PublicApp.js",["181"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\AuthContext.js",[],["182","183"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\reportWebVitals.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\api\\notesApi.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\getCaretCoordinates.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\editableBlock\\EditableBlock.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\blockEditor\\BlockEditor.jsx",["184","185","186"],"import React, { useEffect, useState } from \"react\";\r\n// @ts-ignore\r\nimport styles from \"./blockEditor.module.css\";\r\nimport EditableBlock from \"../../components/editableBlock/EditableBlock\";\r\nimport { setCaretToEnd } from \"../../helpers/setCaretToEnd\";\r\nimport usePrevious from \"../../hooks/usePrevious\";\r\nimport * as notesApi from \"../../api/notesApi\";\r\nimport objectId from \"../../helpers/objectId\";\r\nimport { DragDropContext, Droppable } from \"react-beautiful-dnd\";\r\n\r\nconst BlockEditor = ({ pageId, accessToken, fetchedBlocks }) => {\r\n  const [blocks, setBlocks] = useState(fetchedBlocks);\r\n  const [currentBlockId, setCurrentBlockId] = useState(null);\r\n  const prevBlocks = usePrevious(blocks);\r\n\r\n  useEffect(() => {\r\n    console.log(\"new fetched blocks\");\r\n    if (fetchedBlocks.length === 0) console.log(\"array length is 0\");\r\n    setBlocks(fetchedBlocks);\r\n    setCurrentBlockId(null);\r\n    // console.log(fetchedBlocks);\r\n  }, [fetchedBlocks]);\r\n\r\n  const updatePageOnServer = async (blocks) => {\r\n    // console.log(\"UPDATING SERVER WITH BLOCKS: \" + JSON.stringify(blocks));\r\n    notesApi.updatePage(accessToken, pageId, blocks);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevBlocks && prevBlocks !== blocks) {\r\n      updatePageOnServer({ blocks: blocks });\r\n    }\r\n  }, [blocks, prevBlocks]);\r\n\r\n  // Handling the cursor and focus on adding and deleting blocks\r\n  useEffect(() => {\r\n    // If a new block was added, move the caret to it\r\n    if (prevBlocks && prevBlocks.length + 1 === blocks.length) {\r\n      const nextBlockPosition =\r\n        blocks.map((b) => b._id).indexOf(currentBlockId) + 1 + 1;\r\n      const nextBlock = document.querySelector(\r\n        `[data-position=\"${nextBlockPosition}\"]`\r\n      );\r\n      if (nextBlock) {\r\n        nextBlock.focus();\r\n      }\r\n    }\r\n    // If a block was deleted, move the caret to the end of the last block\r\n    if (prevBlocks && prevBlocks.length - 1 === blocks.length) {\r\n      const lastBlockPosition = prevBlocks\r\n        .map((b) => b._id)\r\n        .indexOf(currentBlockId);\r\n      const lastBlock = document.querySelector(\r\n        `[data-position=\"${lastBlockPosition}\"]`\r\n      );\r\n      if (lastBlock) {\r\n        setCaretToEnd(lastBlock);\r\n      }\r\n    }\r\n  }, [blocks, prevBlocks, currentBlockId]);\r\n\r\n  // Здесь мы обновляем общий стейт с блоками, а это в свою очередь триггерит useEffect на blocks и prevBlocks, в этом юз эффекте нам и нужно посылать запросы с обновлениями на сервер.\r\n  const updateBlockHandler = (currentBlock) => {\r\n    // console.log(\"In update block handler\");\r\n    const index = blocks.map((b) => b._id).indexOf(currentBlock.id);\r\n    const oldBlock = blocks[index];\r\n    const updatedBlocks = [...blocks];\r\n\r\n    updatedBlocks[index] = {\r\n      ...updatedBlocks[index],\r\n      tag: currentBlock.tag,\r\n      html: currentBlock.html,\r\n      counter: currentBlock.counter,\r\n    };\r\n    setBlocks(updatedBlocks);\r\n  };\r\n\r\n  // Вот здесь какая-то муть\r\n  const addBlockHandler = (currentBlock) => {\r\n    // console.log(currentBlock);\r\n    setCurrentBlockId(currentBlock.id);\r\n    const index = blocks.map((b) => b._id).indexOf(currentBlock.id);\r\n    // console.log(index);\r\n    const updatedBlocks = [...blocks];\r\n    const newBlock = { _id: objectId(), tag: \"p\", html: \"\" };\r\n    updatedBlocks.splice(index + 1, 0, newBlock);\r\n    // console.log(\"Updated blocks: \" + updatedBlocks);\r\n    updatedBlocks[index] = {\r\n      ...updatedBlocks[index],\r\n      tag: currentBlock.tag,\r\n      html: currentBlock.html,\r\n    };\r\n    setBlocks(updatedBlocks);\r\n  };\r\n\r\n  const deleteBlockHandler = (currentBlock) => {\r\n    if (blocks.length > 1) {\r\n      setCurrentBlockId(currentBlock.id);\r\n      const index = blocks.map((b) => b._id).indexOf(currentBlock.id);\r\n      const deletedBlock = blocks[index];\r\n      const updatedBlocks = [...blocks];\r\n      updatedBlocks.splice(index, 1);\r\n      setBlocks(updatedBlocks);\r\n    }\r\n  };\r\n\r\n  const onDragEndHandler = (result) => {\r\n    const { destination, source } = result;\r\n\r\n    // If we don't have a destination (due to dropping outside the droppable)\r\n    // or the destination hasn't changed, we change nothing\r\n    if (!destination || destination.index === source.index) {\r\n      return;\r\n    }\r\n\r\n    const updatedBlocks = [...blocks];\r\n    const removedBlocks = updatedBlocks.splice(source.index - 1, 1);\r\n    updatedBlocks.splice(destination.index - 1, 0, removedBlocks[0]);\r\n    setBlocks(updatedBlocks);\r\n    console.log(destination, source);\r\n  };\r\n\r\n  return (\r\n    <DragDropContext onDragEnd={onDragEndHandler}>\r\n      <div className={styles.editor}>\r\n        <Droppable droppableId={pageId}>\r\n          {(provided) => (\r\n            <div\r\n              ref={provided.innerRef}\r\n              {...provided.droppableProps}\r\n              className={styles.droppable}\r\n            >\r\n              {blocks.map((block) => {\r\n                const position =\r\n                  blocks.map((b) => b._id).indexOf(block._id) + 1;\r\n                return (\r\n                  <EditableBlock\r\n                    key={block._id}\r\n                    position={position}\r\n                    id={block._id}\r\n                    tag={block.tag}\r\n                    html={block.html}\r\n                    addBlock={addBlockHandler}\r\n                    deleteBlock={deleteBlockHandler}\r\n                    updatePage={updateBlockHandler}\r\n                    counter={block.counter}\r\n                  />\r\n                );\r\n              })}\r\n              {provided.placeholder}\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </div>\r\n    </DragDropContext>\r\n  );\r\n};\r\n\r\nexport default BlockEditor;\r\n","C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\setCaretToEnd.js",[],["187","188"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\routes\\privateRoutes.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\index.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\hooks\\useComponentDidUpdate.js",["189","190"],"import { useRef, useEffect } from \"react\";\r\n\r\nexport const useComponentDidUpdate = (effect, dependencies) => {\r\n  const hasMounted = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (!hasMounted.current) {\r\n      hasMounted.current = true;\r\n      return;\r\n    }\r\n    effect();\r\n  }, dependencies);\r\n};\r\n","C:\\Users\\user\\dev\\epic-note\\client\\src\\context\\actions.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\routes\\publicRoutes.js",["191"],"import React from \"react\";\r\nimport { Route, Switch, Redirect } from \"react-router-dom\";\r\nimport App from \"../App\";\r\nimport LoginPage from \"../pages/login/LoginPage\";\r\nimport RegisterPage from \"../pages/register/RegisterPage\";\r\n\r\n// Todo: здесь нужно будет редиректить пользователя, если он не залогинен.\r\n// Todo: Добавить страницу showcase, которая будет показываться в первый раз незалогиненным пользователям\r\n\r\nlet publicRoutes = (\r\n  <Switch>\r\n    <Route\r\n      exact\r\n      path=\"/\"\r\n      render={() => <Redirect to={{ pathname: \"/login\" }} />}\r\n      key=\"home\"\r\n    />\r\n    ,\r\n    <Route path=\"/login\" component={LoginPage} key=\"login\" />,\r\n    <Route path=\"/register\" component={RegisterPage} key=\"register\" />,\r\n    <Route render={() => <Redirect to={{ pathname: \"/\" }} />} />\r\n  </Switch>\r\n);\r\n\r\nexport default publicRoutes;\r\n","C:\\Users\\user\\dev\\epic-note\\client\\src\\api\\authApi.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\AddPageModal.js",[],["192","193"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\pages\\register\\RegisterPage.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\RegisterForm.js",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\helpers\\objectId.js",[],["194","195"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\ButtonBlock.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\FolderTree.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\PageItem.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\hooks\\usePrevious.js",[],["196","197"],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\actionMenu\\ActionMenu.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\ToggleList.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\TodoList.jsx",[],"C:\\Users\\user\\dev\\epic-note\\client\\src\\components\\Placeholder.js",[],{"ruleId":"198","replacedBy":"199"},{"ruleId":"200","replacedBy":"201"},{"ruleId":"198","replacedBy":"202"},{"ruleId":"200","replacedBy":"203"},{"ruleId":"204","severity":1,"message":"205","line":1,"column":17,"nodeType":"206","messageId":"207","endLine":1,"endColumn":26},{"ruleId":"204","severity":1,"message":"208","line":7,"column":10,"nodeType":"206","messageId":"207","endLine":7,"endColumn":14},{"ruleId":"204","severity":1,"message":"209","line":25,"column":9,"nodeType":"206","messageId":"207","endLine":25,"endColumn":16},{"ruleId":"204","severity":1,"message":"210","line":35,"column":11,"nodeType":"206","messageId":"207","endLine":35,"endColumn":17},{"ruleId":"204","severity":1,"message":"211","line":10,"column":25,"nodeType":"206","messageId":"207","endLine":10,"endColumn":31},{"ruleId":"212","severity":1,"message":"213","line":19,"column":6,"nodeType":"214","endLine":19,"endColumn":8,"suggestions":"215"},{"ruleId":"212","severity":1,"message":"216","line":27,"column":6,"nodeType":"214","endLine":27,"endColumn":8,"suggestions":"217"},{"ruleId":"198","replacedBy":"218"},{"ruleId":"200","replacedBy":"219"},{"ruleId":"204","severity":1,"message":"220","line":6,"column":3,"nodeType":"206","messageId":"207","endLine":6,"endColumn":13},{"ruleId":"204","severity":1,"message":"221","line":10,"column":3,"nodeType":"206","messageId":"207","endLine":10,"endColumn":7},{"ruleId":"204","severity":1,"message":"222","line":12,"column":3,"nodeType":"206","messageId":"207","endLine":12,"endColumn":7},{"ruleId":"204","severity":1,"message":"223","line":13,"column":3,"nodeType":"206","messageId":"207","endLine":13,"endColumn":7},{"ruleId":"204","severity":1,"message":"224","line":14,"column":3,"nodeType":"206","messageId":"207","endLine":14,"endColumn":13},{"ruleId":"204","severity":1,"message":"225","line":15,"column":3,"nodeType":"206","messageId":"207","endLine":15,"endColumn":11},{"ruleId":"204","severity":1,"message":"226","line":16,"column":3,"nodeType":"206","messageId":"207","endLine":16,"endColumn":11},{"ruleId":"204","severity":1,"message":"227","line":39,"column":17,"nodeType":"206","messageId":"207","endLine":39,"endColumn":22},{"ruleId":"204","severity":1,"message":"228","line":39,"column":35,"nodeType":"206","messageId":"207","endLine":39,"endColumn":42},{"ruleId":"204","severity":1,"message":"205","line":1,"column":10,"nodeType":"206","messageId":"207","endLine":1,"endColumn":19},{"ruleId":"198","replacedBy":"229"},{"ruleId":"200","replacedBy":"230"},{"ruleId":"212","severity":1,"message":"231","line":33,"column":6,"nodeType":"214","endLine":33,"endColumn":26,"suggestions":"232"},{"ruleId":"204","severity":1,"message":"233","line":66,"column":11,"nodeType":"206","messageId":"207","endLine":66,"endColumn":19},{"ruleId":"204","severity":1,"message":"234","line":100,"column":13,"nodeType":"206","messageId":"207","endLine":100,"endColumn":25},{"ruleId":"198","replacedBy":"235"},{"ruleId":"200","replacedBy":"236"},{"ruleId":"212","severity":1,"message":"237","line":12,"column":6,"nodeType":"206","endLine":12,"endColumn":18},{"ruleId":"212","severity":1,"message":"238","line":12,"column":6,"nodeType":"206","endLine":12,"endColumn":18,"suggestions":"239"},{"ruleId":"204","severity":1,"message":"240","line":3,"column":8,"nodeType":"206","messageId":"207","endLine":3,"endColumn":11},{"ruleId":"198","replacedBy":"241"},{"ruleId":"200","replacedBy":"242"},{"ruleId":"198","replacedBy":"243"},{"ruleId":"200","replacedBy":"244"},{"ruleId":"198","replacedBy":"245"},{"ruleId":"200","replacedBy":"246"},"no-native-reassign",["247"],"no-negated-in-lhs",["248"],["247"],["248"],"no-unused-vars","'useEffect' is defined but never used.","Identifier","unusedVar","'Link' is defined but never used.","'history' is assigned a value but never used.","'isAuth' is assigned a value but never used.","'logout' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'refreshToken'. Either include it or remove the dependency array.","ArrayExpression",["249"],"React Hook useEffect has a missing dependency: 'history'. Either include it or remove the dependency array.",["250"],["247"],["248"],"'IconButton' is defined but never used.","'Text' is defined but never used.","'Icon' is defined but never used.","'Menu' is defined but never used.","'MenuButton' is defined but never used.","'MenuList' is defined but never used.","'MenuItem' is defined but never used.","'error' is assigned a value but never used.","'isError' is assigned a value but never used.",["247"],["248"],"React Hook useEffect has a missing dependency: 'updatePageOnServer'. Either include it or remove the dependency array.",["251"],"'oldBlock' is assigned a value but never used.","'deletedBlock' is assigned a value but never used.",["247"],["248"],"React Hook useEffect was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","React Hook useEffect has a missing dependency: 'effect'. Either include it or remove the dependency array. If 'effect' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["252"],"'App' is defined but never used.",["247"],["248"],["247"],["248"],["247"],["248"],"no-global-assign","no-unsafe-negation",{"desc":"253","fix":"254"},{"desc":"255","fix":"256"},{"desc":"257","fix":"258"},{"desc":"259","fix":"260"},"Update the dependencies array to be: [refreshToken]",{"range":"261","text":"262"},"Update the dependencies array to be: [history]",{"range":"263","text":"264"},"Update the dependencies array to be: [blocks, prevBlocks, updatePageOnServer]",{"range":"265","text":"266"},"Update the dependencies array to be: [effect]",{"range":"267","text":"268"},[638,640],"[refreshToken]",[859,861],"[history]",[1277,1297],"[blocks, prevBlocks, updatePageOnServer]",[280,292],"[effect]"]